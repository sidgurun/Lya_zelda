

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Tutorial : Fitting a line profile using deep learning &mdash; zELDA 0.0.01 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial : Fitting a line profile using Monte Carlo Markov Chains" href="Tutorial_MCMC.html" />
    <link rel="prev" title="Tutorial : Computing mock line profiles" href="Tutorial_mock.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> zELDA
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="About_the_data_grids.html">About the LyaRT data grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_ideal.html">Tutorial : Computing ideal line profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_mock.html">Tutorial : Computing mock line profiles</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial : Fitting a line profile using deep learning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-dnn-in-the-un-perturbed-line-profile">Using the DNN in the un-perturbed line profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-dnn-with-monte-carlo-perturbations">Using the DNN with Monte Carlo perturbations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_MCMC.html">Tutorial : Fitting a line profile using Monte Carlo Markov Chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_fesc.html">Tutorial : Computing Lyman-alpha escape fractions</a></li>
<li class="toctree-l1"><a class="reference internal" href="funcs.html">funcs module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">zELDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Tutorial : Fitting a line profile using deep learning</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Tutorial_DNN.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial-fitting-a-line-profile-using-deep-learning">
<h1>Tutorial : Fitting a line profile using deep learning<a class="headerlink" href="#tutorial-fitting-a-line-profile-using-deep-learning" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial you will, hopefully, learn how fit Lyman-alpha line profiles ussing deep learning with <cite>zELDA</cite>.</p>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>Let’s start by loading <cite>zELDA</cite> creating a mock line profile that we will fit later. For more details on how to create a mock line profile go to <a class="reference internal" href="Tutorial_mock.html"><span class="doc">Mock line profiles</span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">Lya_zelda</span> <span class="kn">as</span> <span class="nn">Lya</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">your_grids_location</span> <span class="o">=</span> <span class="s1">&#39;/This/Folder/Contains/The/Grids/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lya</span><span class="o">.</span><span class="n">funcs</span><span class="o">.</span><span class="n">Data_location</span> <span class="o">=</span> <span class="n">your_grids_location</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Geometry</span> <span class="o">=</span> <span class="s1">&#39;Thin_Shell_Cont&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Defining the model parameters:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_t</span>      <span class="o">=</span> <span class="mf">0.5</span>   <span class="c1"># redshift of the source</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_t</span>      <span class="o">=</span> <span class="mf">50.0</span>  <span class="c1"># Outflow expansion velocity [km/s]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_N_t</span>  <span class="o">=</span> <span class="mf">20.</span>   <span class="c1"># Logarithmic of the neutral hydrogen column density [cm**-2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_t</span>      <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># Dust optical depth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_EW_t</span> <span class="o">=</span> <span class="mf">1.5</span>   <span class="c1"># Logarithmic the intrinsic equivalent width [A]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">W_t</span>      <span class="o">=</span> <span class="mf">0.5</span>   <span class="c1"># Intrinsic width of the line [A]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F_t</span>      <span class="o">=</span> <span class="mf">1.</span>    <span class="c1"># Total flux of the line</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Defining the quality of the line profile:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PNR_t</span>  <span class="o">=</span> <span class="mf">15.0</span> <span class="c1"># Signal to noise ratio of the maximum of the line.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FWHM_t</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Full width half maximum diluting the line. Mimics finite resolution. [A]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PIX_t</span>  <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Wavelength binning of the line. [A]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">w_Arr</span> <span class="p">,</span> <span class="n">f_Arr</span> <span class="p">,</span> <span class="n">s_Arr</span> <span class="o">=</span> <span class="n">Lya</span><span class="o">.</span><span class="n">Generate_a_real_line</span><span class="p">(</span> <span class="n">z_t</span> <span class="p">,</span> <span class="n">V_t</span><span class="p">,</span> <span class="n">log_N_t</span><span class="p">,</span> <span class="n">t_t</span><span class="p">,</span> <span class="n">F_t</span><span class="p">,</span> <span class="n">log_EW_t</span><span class="p">,</span> <span class="n">W_t</span> <span class="p">,</span> <span class="n">PNR_t</span><span class="p">,</span> <span class="n">FWHM_t</span><span class="p">,</span> <span class="n">PIX_t</span><span class="p">,</span> <span class="n">LyaRT_Grid</span><span class="p">,</span> <span class="n">Geometry</span> <span class="p">)</span>
</pre></div>
</div>
<p>where <cite>/This/Folder/Contains/The/Grids/</cite> is the place where you store the LyaRT data grids, as shown in the installation section. And… It’s done! <cite>w_Arr</cite> is a numpy array that contains the wavelength where the line profile is evaluated. Meanwhile, <cite>f_Arr</cite> is the actuall line profile. <cite>s_Arr</cite> is the uncertainty of the flux density.</p>
<p>Let’s have a look to how the line looks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w_Arr</span> <span class="p">,</span> <span class="n">f_Arr</span> <span class="p">,</span> <span class="n">s_Arr</span>  <span class="o">=</span> <span class="n">Lya</span><span class="o">.</span><span class="n">Generate_a_real_line</span><span class="p">(</span> <span class="n">z_t</span> <span class="p">,</span> <span class="n">V_t</span><span class="p">,</span> <span class="n">log_N_t</span><span class="p">,</span> <span class="n">t_t</span><span class="p">,</span> <span class="n">F_t</span><span class="p">,</span> <span class="n">log_EW_t</span><span class="p">,</span> <span class="n">W_t</span> <span class="p">,</span> <span class="n">PNR_t</span><span class="p">,</span> <span class="n">FWHM_t</span><span class="p">,</span> <span class="n">PIX_t</span><span class="p">,</span> <span class="n">LyaRT_Grid</span><span class="p">,</span> <span class="n">Geometry</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">w_pix_Arr</span> <span class="p">,</span> <span class="n">f_pix_Arr</span> <span class="o">=</span> <span class="n">Lya</span><span class="o">.</span><span class="n">plot_a_rebinned_line</span><span class="p">(</span> <span class="n">w_Arr</span> <span class="p">,</span> <span class="n">f_Arr</span> <span class="p">,</span> <span class="n">PIX_t</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">w_pix_Arr</span> <span class="p">,</span> <span class="n">f_pix_Arr</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;wavelength[A]&#39;</span> <span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux density [a.u.]&#39;</span> <span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1815</span><span class="p">,</span><span class="mi">1835</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig_Tutorial_3_1.png"><img alt="_images/fig_Tutorial_3_1.png" src="_images/fig_Tutorial_3_1.png" style="width: 600px;" /></a>
<p>Now that we have our mock line profile. Let’s load the neural network. As we have produce a line profile for an outflow (<cite>V_t</cite>&gt;0) we are going to load the deep neural network for outflows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">machine_data</span> <span class="o">=</span>  <span class="n">Lya</span><span class="o">.</span><span class="n">Load_NN_model</span><span class="p">(</span> <span class="s1">&#39;Outflow&#39;</span> <span class="p">)</span>
</pre></div>
</div>
<p>In case you want to do the anlysis for inflows just call <cite>Lya.Load_NN_model( ‘Inflow’ )</cite>. <cite>machine_data</cite> is a python dictionary that contains all the necessary data for the deep neural network approach. Let’s pick up from it two variables:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">machine</span>    <span class="o">=</span> <span class="n">machine_data</span><span class="p">[</span><span class="s1">&#39;Machine&#39;</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w_rest_Arr</span> <span class="o">=</span> <span class="n">machine_data</span><span class="p">[</span> <span class="s1">&#39;w_rest&#39;</span> <span class="p">]</span>
</pre></div>
</div>
<p><cite>machine</cite> is an object from skitlearn with the trained neural netwrok and <cite>w_rest_Arr</cite> is the rest frame wavelength where the line profiles used for the training were evaluated. <cite>w_rest_Arr</cite> is important to check that the neural networks is working in the same wavelength array that the line profiles will be evaluated. In principle you don’t have to do anything with <cite>w_rest_Arr</cite>, but we need to pass it to other functions.</p>
</div>
<div class="section" id="using-the-dnn-in-the-un-perturbed-line-profile">
<h2>Using the DNN in the un-perturbed line profile<a class="headerlink" href="#using-the-dnn-in-the-un-perturbed-line-profile" title="Permalink to this headline">¶</a></h2>
<p>Let’s start by simple evaluating the DNN using the mock line profile without perturbing it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Sol</span> <span class="p">,</span> <span class="n">z_sol</span> <span class="o">=</span> <span class="n">Lya</span><span class="o">.</span><span class="n">NN_measure</span><span class="p">(</span> <span class="n">w_Arr</span> <span class="p">,</span> <span class="n">f_Arr</span> <span class="p">,</span> <span class="n">s_Arr</span> <span class="p">,</span> <span class="n">FWHM_t</span> <span class="p">,</span> <span class="n">PIX_t</span> <span class="p">,</span> <span class="n">machine</span> <span class="p">,</span> <span class="n">w_rest_Arr</span> <span class="p">,</span> <span class="n">N_iter</span><span class="o">=</span><span class="bp">None</span> <span class="p">)</span>
</pre></div>
</div>
<p>Done! . <cite>Sol</cite> is a matrix that contains the prediction by the DNN and <cite>z_sol</cite> is the predicted redshift. You can print the predicted properties doing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The measured redshift                                                     is&#39;</span> <span class="p">,</span> <span class="n">z_sol</span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The measured logarithm of the expasion velocity                           is&#39;</span> <span class="p">,</span> <span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The measured logarithm of the HI column density                           is&#39;</span> <span class="p">,</span> <span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The measured logarithm of the dust optical depth                          is&#39;</span> <span class="p">,</span> <span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The measured logarithm of the intrinsic equivalent width                  is&#39;</span> <span class="p">,</span> <span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The measured logarithm of the intrinsic            width                  is&#39;</span> <span class="p">,</span> <span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The measured shift of the true Lya wavelgnth from the maximum of the line is&#39;</span> <span class="p">,</span> <span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<p>This should give something like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">measured</span> <span class="n">redshift</span>                                                     <span class="ow">is</span> <span class="mf">0.49994403239322693</span>
<span class="n">The</span> <span class="n">measured</span> <span class="n">logarithm</span> <span class="n">of</span> <span class="n">the</span> <span class="n">expasion</span> <span class="n">velocity</span>                           <span class="ow">is</span> <span class="mf">1.5821419036064905</span>
<span class="n">The</span> <span class="n">measured</span> <span class="n">logarithm</span> <span class="n">of</span> <span class="n">the</span> <span class="n">HI</span> <span class="n">column</span> <span class="n">density</span>                           <span class="ow">is</span> <span class="mf">20.149247231711733</span>
<span class="n">The</span> <span class="n">measured</span> <span class="n">logarithm</span> <span class="n">of</span> <span class="n">the</span> <span class="n">dust</span> <span class="n">optical</span> <span class="n">depth</span>                          <span class="ow">is</span> <span class="o">-</span><span class="mf">3.310662004999448</span>
<span class="n">The</span> <span class="n">measured</span> <span class="n">logarithm</span> <span class="n">of</span> <span class="n">the</span> <span class="n">intrinsic</span> <span class="n">equivalent</span> <span class="n">width</span>                  <span class="ow">is</span> <span class="mf">1.458352960574508</span>
<span class="n">The</span> <span class="n">measured</span> <span class="n">logarithm</span> <span class="n">of</span> <span class="n">the</span> <span class="n">intrinsic</span>            <span class="n">width</span>                  <span class="ow">is</span> <span class="o">-</span><span class="mf">0.804093047888869</span>
<span class="n">The</span> <span class="n">measured</span> <span class="n">shift</span> <span class="n">of</span> <span class="n">the</span> <span class="n">true</span> <span class="n">Lya</span> <span class="n">wavelgnth</span> <span class="kn">from</span> <span class="nn">the</span> <span class="nn">maximum</span> <span class="nn">of</span> <span class="nn">the</span> <span class="nn">line</span> <span class="nn">is</span> <span class="o">-</span><span class="mf">1.2773994188976223</span>
</pre></div>
</div>
<p>Let’s see how this new spectrum compares with the target:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">PNR</span> <span class="o">=</span> <span class="mf">100000.</span> <span class="c1"># let&#39;s put infinite signal to noise in the model line</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">V_sol</span>    <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Expansion velocity km/s</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logN_sol</span> <span class="o">=</span>     <span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># log of HI column density cm**-2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_sol</span>    <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># dust optical depth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logE_sol</span> <span class="o">=</span>     <span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="c1"># log intrinsic EW [A]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">W_sol</span>    <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">Sol</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="c1"># intrinsic width [A]</span>

<span class="go"># creates the line</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">w_One_Arr</span> <span class="p">,</span> <span class="n">f_One_Arr</span> <span class="p">,</span> <span class="n">_</span>  <span class="o">=</span> <span class="n">Lya</span><span class="o">.</span><span class="n">Generate_a_real_line</span><span class="p">(</span> <span class="n">z_sol</span> <span class="p">,</span> <span class="n">V_sol</span><span class="p">,</span> <span class="n">logN_sol</span><span class="p">,</span> <span class="n">t_sol</span><span class="p">,</span> <span class="n">F_t</span><span class="p">,</span> <span class="n">logE_sol</span><span class="p">,</span> <span class="n">W_sol</span><span class="p">,</span> <span class="n">PNR</span><span class="p">,</span> <span class="n">FWHM_t</span><span class="p">,</span> <span class="n">PIX_t</span><span class="p">,</span> <span class="n">LyaRT_Grid</span><span class="p">,</span> <span class="n">Geometry</span> <span class="p">)</span>

<span class="go"># plot the target and the predicted line</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">w_pix_One_Arr</span> <span class="p">,</span> <span class="n">f_pix_One_Arr</span> <span class="o">=</span> <span class="n">Lya</span><span class="o">.</span><span class="n">plot_a_rebinned_line</span><span class="p">(</span> <span class="n">w_One_Arr</span> <span class="p">,</span> <span class="n">f_One_Arr</span> <span class="p">,</span> <span class="n">PIX_t</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">w_pix_Arr</span>     <span class="p">,</span> <span class="n">f_pix_Arr</span>     <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Target&#39;</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">w_pix_One_Arr</span> <span class="p">,</span> <span class="n">f_pix_One_Arr</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1 iter&#39;</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;wavelength[A]&#39;</span> <span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux density [a.u.]&#39;</span> <span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1815</span><span class="p">,</span><span class="mi">1835</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>You should get something like:</p>
<a class="reference internal image-reference" href="_images/fig_Tutorial_3_2.png"><img alt="_images/fig_Tutorial_3_2.png" src="_images/fig_Tutorial_3_2.png" style="width: 600px;" /></a>
</div>
<div class="section" id="using-the-dnn-with-monte-carlo-perturbations">
<h2>Using the DNN with Monte Carlo perturbations<a class="headerlink" href="#using-the-dnn-with-monte-carlo-perturbations" title="Permalink to this headline">¶</a></h2>
<p>Normally, it is better to do more than one iteration, as it leads to better results. These iterations basically perturb the flux density <cite>f_Arr</cite> by adding gaussian noise with the applitude of <cite>s_Arr</cite> in each wavelength bin. Then, this new perturbed spectrum is send to the DNN. For each of these iterations the output of the DNN is stored. For example for 1000 iterations :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Sol</span> <span class="p">,</span> <span class="n">z_sol</span> <span class="p">,</span> <span class="n">log_V_Arr</span> <span class="p">,</span> <span class="n">log_N_Arr</span> <span class="p">,</span> <span class="n">log_t_Arr</span> <span class="p">,</span> <span class="n">z_Arr</span> <span class="p">,</span> <span class="n">log_E_Arr</span> <span class="p">,</span> <span class="n">log_W_Arr</span> <span class="o">=</span> <span class="n">Lya</span><span class="o">.</span><span class="n">NN_measure</span><span class="p">(</span> <span class="n">w_Arr</span> <span class="p">,</span> <span class="n">f_Arr</span> <span class="p">,</span> <span class="n">s_Arr</span> <span class="p">,</span> <span class="n">FWHM_t</span> <span class="p">,</span> <span class="n">PIX_t</span> <span class="p">,</span> <span class="n">machine</span> <span class="p">,</span> <span class="n">w_rest_Arr</span> <span class="p">,</span> <span class="n">N_iter</span><span class="o">=</span><span class="mi">1000</span> <span class="p">)</span>
</pre></div>
</div>
<p>The arrays <cite>log_V_Arr</cite>, <cite>log_N_Arr</cite>, <cite>log_t_Arr</cite>, <cite>z_Arr</cite>, <cite>log_E_Arr</cite> and <cite>log_W_Arr</cite> contain the output of the DNN for the iterations for the logarithms of the expansion velocity, the logarithm of the neutral hydrogen column density, the logarithm of the dust optical depth, the redshift, the logarithm of the intrinsic equivalent width and the logarithm of the intrinsic width of the line. From these arrays we can compute the result from the DNN analysis by taking the 50th percentile. The +-1 sigma uncertainty can be computed as the 16th and 84th percentile.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Redshitft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_50</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span>    <span class="n">z_Arr</span> <span class="p">,</span> <span class="mi">50</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_16</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span>    <span class="n">z_Arr</span> <span class="p">,</span> <span class="mi">16</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_84</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span>    <span class="n">z_Arr</span> <span class="p">,</span> <span class="mi">84</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Expansion velocity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_50</span>     <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_V_Arr</span> <span class="p">,</span> <span class="mi">50</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_16</span>     <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_V_Arr</span> <span class="p">,</span> <span class="mi">16</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V_84</span>     <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_V_Arr</span> <span class="p">,</span> <span class="mi">84</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Logarithmic of HI column density</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_N_50</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_N_Arr</span> <span class="p">,</span> <span class="mi">50</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_N_16</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_N_Arr</span> <span class="p">,</span> <span class="mi">16</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_N_84</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_N_Arr</span> <span class="p">,</span> <span class="mi">84</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Dust optical depth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_50</span>     <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_t_Arr</span> <span class="p">,</span> <span class="mi">50</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_16</span>     <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_t_Arr</span> <span class="p">,</span> <span class="mi">16</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_84</span>     <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_t_Arr</span> <span class="p">,</span> <span class="mi">84</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Logarithmic of intrinsic equivalent width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_E_50</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_E_Arr</span> <span class="p">,</span> <span class="mi">50</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_E_16</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_E_Arr</span> <span class="p">,</span> <span class="mi">16</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_E_84</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_E_Arr</span> <span class="p">,</span> <span class="mi">84</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Intrinsic width</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">W_50</span>     <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_W_Arr</span> <span class="p">,</span> <span class="mi">50</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">W_16</span>     <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_W_Arr</span> <span class="p">,</span> <span class="mi">16</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">W_84</span>     <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span> <span class="n">log_W_Arr</span> <span class="p">,</span> <span class="mi">84</span> <span class="p">)</span>
</pre></div>
</div>
<p>let’s see how the line profiles look:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute the 100 iterations line profile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w_50th_Arr</span> <span class="p">,</span> <span class="n">f_50th_Arr</span> <span class="p">,</span> <span class="n">_</span>  <span class="o">=</span> <span class="n">Lya</span><span class="o">.</span><span class="n">Generate_a_real_line</span><span class="p">(</span> <span class="n">z_50</span> <span class="p">,</span> <span class="n">V_50</span><span class="p">,</span> <span class="n">log_N_50</span><span class="p">,</span> <span class="n">t_50</span><span class="p">,</span> <span class="n">F_t</span><span class="p">,</span> <span class="n">log_E_50</span><span class="p">,</span> <span class="n">W_50</span><span class="p">,</span> <span class="n">PNR</span><span class="p">,</span> <span class="n">FWHM_t</span><span class="p">,</span> <span class="n">PIX_t</span><span class="p">,</span> <span class="n">LyaRT_Grid</span><span class="p">,</span> <span class="n">Geometry</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get cooler profiles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w_pix_50th_Arr</span> <span class="p">,</span> <span class="n">f_pix_50th_Arr</span> <span class="o">=</span> <span class="n">Lya</span><span class="o">.</span><span class="n">plot_a_rebinned_line</span><span class="p">(</span> <span class="n">w_50th_Arr</span> <span class="p">,</span> <span class="n">f_50th_Arr</span> <span class="p">,</span> <span class="n">PIX_t</span> <span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">w_pix_Arr</span>      <span class="p">,</span> <span class="n">f_pix_Arr</span>      <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Target&#39;</span>   <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">w_pix_One_Arr</span>  <span class="p">,</span> <span class="n">f_pix_One_Arr</span>  <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1 iter&#39;</span>   <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">w_pix_50th_Arr</span> <span class="p">,</span> <span class="n">f_pix_50th_Arr</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1000 iter&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;wavelength[A]&#39;</span> <span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Flux density [a.u.]&#39;</span> <span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1815</span><span class="p">,</span><span class="mi">1835</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fig_Tutorial_3_3.png"><img alt="_images/fig_Tutorial_3_3.png" src="_images/fig_Tutorial_3_3.png" style="width: 600px;" /></a>
<p>finally, let’s compare the parameters that we got with the input:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The true redshift                 is&#39;</span> <span class="p">,</span> <span class="n">z_t</span>      <span class="p">,</span> <span class="s1">&#39;and the predicted is&#39;</span> <span class="p">,</span> <span class="n">z_50</span>     <span class="p">,</span> <span class="s1">&#39;(-&#39;</span> <span class="p">,</span> <span class="n">z_50</span><span class="o">-</span><span class="n">z_16</span>         <span class="p">,</span> <span class="s1">&#39;, +&#39;</span> <span class="p">,</span> <span class="n">z_84</span><span class="o">-</span><span class="n">z_50</span>         <span class="p">,</span> <span class="s1">&#39;)&#39;</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The true expansion velocity       is&#39;</span> <span class="p">,</span> <span class="n">V_t</span>      <span class="p">,</span> <span class="s1">&#39;and the predicted is&#39;</span> <span class="p">,</span> <span class="n">V_50</span>     <span class="p">,</span> <span class="s1">&#39;(-&#39;</span> <span class="p">,</span> <span class="n">V_50</span><span class="o">-</span><span class="n">V_16</span>         <span class="p">,</span> <span class="s1">&#39;, +&#39;</span> <span class="p">,</span> <span class="n">V_84</span><span class="o">-</span><span class="n">V_50</span>         <span class="p">,</span> <span class="s1">&#39;)&#39;</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The true dust optical depth       is&#39;</span> <span class="p">,</span> <span class="n">t_t</span>      <span class="p">,</span> <span class="s1">&#39;and the predicted is&#39;</span> <span class="p">,</span> <span class="n">t_50</span>     <span class="p">,</span> <span class="s1">&#39;(-&#39;</span> <span class="p">,</span> <span class="n">t_50</span><span class="o">-</span><span class="n">t_16</span>         <span class="p">,</span> <span class="s1">&#39;, +&#39;</span> <span class="p">,</span> <span class="n">t_84</span><span class="o">-</span><span class="n">t_50</span>         <span class="p">,</span> <span class="s1">&#39;)&#39;</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The true intrinsic width          is&#39;</span> <span class="p">,</span> <span class="n">W_t</span>      <span class="p">,</span> <span class="s1">&#39;and the predicted is&#39;</span> <span class="p">,</span> <span class="n">W_50</span>     <span class="p">,</span> <span class="s1">&#39;(-&#39;</span> <span class="p">,</span> <span class="n">W_50</span><span class="o">-</span><span class="n">W_16</span>         <span class="p">,</span> <span class="s1">&#39;, +&#39;</span> <span class="p">,</span> <span class="n">W_84</span><span class="o">-</span><span class="n">W_50</span>         <span class="p">,</span> <span class="s1">&#39;)&#39;</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The true log of HI column density is&#39;</span> <span class="p">,</span> <span class="n">log_N_t</span>  <span class="p">,</span> <span class="s1">&#39;and the predicted is&#39;</span> <span class="p">,</span> <span class="n">log_N_50</span> <span class="p">,</span> <span class="s1">&#39;(-&#39;</span> <span class="p">,</span> <span class="n">log_N_50</span><span class="o">-</span><span class="n">log_N_16</span> <span class="p">,</span> <span class="s1">&#39;, +&#39;</span> <span class="p">,</span> <span class="n">log_N_84</span><span class="o">-</span><span class="n">log_N_50</span> <span class="p">,</span> <span class="s1">&#39;)&#39;</span> <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span> <span class="s1">&#39;The true log of equivalent width  is&#39;</span> <span class="p">,</span> <span class="n">log_EW_t</span> <span class="p">,</span> <span class="s1">&#39;and the predicted is&#39;</span> <span class="p">,</span> <span class="n">log_E_50</span> <span class="p">,</span> <span class="s1">&#39;(-&#39;</span> <span class="p">,</span> <span class="n">log_E_50</span><span class="o">-</span><span class="n">log_E_16</span> <span class="p">,</span> <span class="s1">&#39;, +&#39;</span> <span class="p">,</span> <span class="n">log_E_84</span><span class="o">-</span><span class="n">log_E_50</span> <span class="p">,</span> <span class="s1">&#39;)&#39;</span> <span class="p">)</span>
</pre></div>
</div>
<p>This should give something like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">true</span> <span class="n">redshift</span>                 <span class="ow">is</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">predicted</span> <span class="ow">is</span> <span class="mf">0.49999833428137275</span> <span class="p">(</span><span class="o">-</span> <span class="mf">0.00017321665235831007</span> <span class="p">,</span> <span class="o">+</span> <span class="mf">0.0003615214512187048</span> <span class="p">)</span>
<span class="n">The</span> <span class="n">true</span> <span class="n">expansion</span> <span class="n">velocity</span>       <span class="ow">is</span> <span class="mf">50.0</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">predicted</span> <span class="ow">is</span> <span class="mf">47.070589157142614</span> <span class="p">(</span><span class="o">-</span> <span class="mf">16.100374040796254</span> <span class="p">,</span> <span class="o">+</span> <span class="mf">48.27234502291723</span> <span class="p">)</span>
<span class="n">The</span> <span class="n">true</span> <span class="n">dust</span> <span class="n">optical</span> <span class="n">depth</span>       <span class="ow">is</span> <span class="mf">0.01</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">predicted</span> <span class="ow">is</span> <span class="mf">0.00379679848371737</span> <span class="p">(</span><span class="o">-</span> <span class="mf">0.003483235501588427</span> <span class="p">,</span> <span class="o">+</span> <span class="mf">0.049396128990436335</span> <span class="p">)</span>
<span class="n">The</span> <span class="n">true</span> <span class="n">intrinsic</span> <span class="n">width</span>          <span class="ow">is</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">predicted</span> <span class="ow">is</span> <span class="mf">0.280484205908298</span> <span class="p">(</span><span class="o">-</span> <span class="mf">0.12228181625600373</span> <span class="p">,</span> <span class="o">+</span> <span class="mf">0.2150273326940031</span> <span class="p">)</span>
<span class="n">The</span> <span class="n">true</span> <span class="n">log</span> <span class="n">of</span> <span class="n">HI</span> <span class="n">column</span> <span class="n">density</span> <span class="ow">is</span> <span class="mf">20.0</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">predicted</span> <span class="ow">is</span> <span class="mf">20.019139948537997</span> <span class="p">(</span><span class="o">-</span> <span class="mf">0.5728866241916535</span> <span class="p">,</span> <span class="o">+</span> <span class="mf">0.207985045834004</span> <span class="p">)</span>
<span class="n">The</span> <span class="n">true</span> <span class="n">log</span> <span class="n">of</span> <span class="n">equivalent</span> <span class="n">width</span>  <span class="ow">is</span> <span class="mf">1.5</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">predicted</span> <span class="ow">is</span> <span class="mf">1.5595962407058306</span> <span class="p">(</span><span class="o">-</span> <span class="mf">0.09992888862396399</span> <span class="p">,</span> <span class="o">+</span> <span class="mf">0.16009784914990055</span> <span class="p">)</span>
</pre></div>
</div>
<p>The particular values that you print will be slightly different when you run it, but more or less it should go in the same direction.</p>
<p>Tha was fun, hah? Now you know how to use the deep neural network scheme in <cite>zELDA</cite>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Tutorial_MCMC.html" class="btn btn-neutral float-right" title="Tutorial : Fitting a line profile using Monte Carlo Markov Chains" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Tutorial_mock.html" class="btn btn-neutral float-left" title="Tutorial : Computing mock line profiles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Gurung-Lopez, Siddhartha.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>